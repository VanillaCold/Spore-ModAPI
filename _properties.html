<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Properties &amp; .prop files | Spore ModAPI SDK for creating C++ mods for Spore</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark.css" />
  <link rel="stylesheet" href="m-documentation.css" />
  <link rel="icon" href="Spore_ModAPI_Icon.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m"><img src="Spore_ModAPI_Icon.png" alt="" />Spore ModAPI <span class="m-thin">SDK for creating C++ mods for Spore</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Tutorials</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Properties &amp; .prop files
        </h1>
        <p>How to read and write .prop files, the most common Spore file format.</p>
        <nav class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#Properties_Includes">Required includes</a></li>
            <li><a href="#Properties_Getting">Getting a property list</a></li>
            <li><a href="#Properties_Reading">Reading properties from a list</a></li>
            <li><a href="#Properties_AppProperties">Using AppProperties</a></li>
            <li><a href="#Properties_Adding">Adding properties to a list</a></li>
          </ul>
        </nav>
<aside class="m-note m-info"><h4>Note</h4><p>This tutorial assumes you have read the <em>C++ Basics</em> tutorials.</p></aside><p>If you ever look to the Spore files in a <code>.package</code>, you will see most of them are <code>.prop</code> files. These are very simple files that assign values to properties. An example of <code>.prop</code> file:</p><pre class="m-code"><span class="kt">bool</span><span class="w"> </span><span class="n">modelAdventureCameraAlphas</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>
<span class="n">key</span><span class="w"> </span><span class="n">modelLOD0</span><span class="w"> </span><span class="n">DI_WrapTotem</span><span class="p">.</span><span class="n">rw4</span><span class="w"></span></pre><p>You have more information about this format in the <a href="https://github.com/emd4600/SporeModder-FX/wiki/Property-Lists-(.prop)">Spore modding wiki</a>.</p><section id="Properties_Includes"><h2><a href="#Properties_Includes">Required includes</a></h2><ul><li><code>&lt;Spore\<a href="_properties_8h.html" class="m-doc">Properties.h</a>&gt;</code></li></ul></section><section id="Properties_Getting"><h2><a href="#Properties_Getting">Getting a property list</a></h2><p>A <code>.prop</code> file is represented by an object of the <a href="class_app_1_1_property_list.html" class="m-doc">App::<wbr />PropertyList</a> class. To read a <code>.prop</code> file, you use the <a href="class_app_1_1_i_prop_manager.html#a25dfe22237c065bf1fa5dd3f053dd12f" class="m-doc">GetPropertyList()</a> of the <a href="class_app_1_1_i_prop_manager.html" class="m-doc">PropManager</a>. The method takes the instance and group IDs, and an <code>intrusive_ptr</code> that will store the property list. For example, to get the <code>ConsequenceTraits!clg_meat.prop</code> file:</p><pre class="m-code"><span class="n">PropertyListPtr</span><span class="w"> </span><span class="n">propList</span><span class="p">;</span><span class="w"></span>
<span class="n">PropManager</span><span class="p">.</span><span class="n">GetPropertyList</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="s">&quot;clg_meat&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;ConsequenceTraits&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">propList</span><span class="p">);</span><span class="w"></span></pre><p>The method returns <code>true</code> if the file was read successfully, false otherwise. If it returned <code>true</code>, now <code>propList</code> will contain the data of the file.</p></section><section id="Properties_Reading"><h2><a href="#Properties_Reading">Reading properties from a list</a></h2><p>The <a href="class_app_1_1_property.html" class="m-doc">App::<wbr />Property</a> class provides many static methods to get the value of a property.</p><p>To get a single value, you must use the <code><a href="_object_8h.html#a2e82adf9870bdb442cdcf2b3e01315b2" class="m-doc">GetX()</a></code> methods, where X is the type of property. First you have to declare the variable where the value will be stored, and then call the method giving the property list, the ID of the property, and the variable. The method requires a raw pointer (<code>*</code>) instead of an <code>intrusive_ptr</code>, so we use <code>.<a href="_object_8h.html#a2e82adf9870bdb442cdcf2b3e01315b2" class="m-doc">get()</a></code> on the property list to get it. For example:</p><pre class="m-code"><span class="kt">float</span><span class="w"> </span><span class="n">scale</span><span class="p">;</span><span class="w"></span>
<span class="n">App</span><span class="o">::</span><span class="n">Property</span><span class="o">::</span><span class="n">GetFloat</span><span class="p">(</span><span class="n">propList</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span><span class="w"> </span><span class="mh">0x00FBA611</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">);</span><span class="w">  </span><span class="c1">// modelScale</span>

<span class="n">ResourceKey</span><span class="w"> </span><span class="n">modelName</span><span class="p">;</span><span class="w"></span>
<span class="n">App</span><span class="o">::</span><span class="n">Property</span><span class="o">::</span><span class="n">GetKey</span><span class="p">(</span><span class="n">propList</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span><span class="w"> </span><span class="mh">0x00F9EFBB</span><span class="p">,</span><span class="w"> </span><span class="n">modelName</span><span class="p">);</span><span class="w">  </span><span class="c1">// modelMeshLOD0</span></pre><p>The method returns <code>true</code> if the propery was found and of the type requested, so the value should only be used if it returned <code>true</code>.</p><p>Some properties come in arrays, that is, a single property may have multiple values. You can access them with <code><a href="_object_8h.html#a2e82adf9870bdb442cdcf2b3e01315b2" class="m-doc">GetArrayX()</a></code>, which will provide you with a pointer to the values and the count of how many values there are.</p><pre class="m-code"><span class="n">ResourceKey</span><span class="o">*</span><span class="w"> </span><span class="n">names</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="n">App</span><span class="o">::</span><span class="n">Property</span><span class="o">::</span><span class="n">GetArrayKey</span><span class="p">(</span><span class="n">propList</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span><span class="w"> </span><span class="mh">0x02A907B5</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">names</span><span class="p">);</span><span class="w">  </span><span class="c1">// modelEffect</span>
<span class="c1">// Now you can access them like names[0], names[1], ...</span></pre><aside class="m-note m-info"><h4>Note</h4><p>Usually it is not possible to use <code><a href="_hash_8h.html#a7ea467872702682e6ee152563a5e00c7" class="m-doc">id()</a></code> to get the ID of a property. <a href="https://emd4600.github.io/SporeModder-FX/">SporeModder FX</a> can be used to get it.</p></aside></section><section id="Properties_AppProperties"><h2><a href="#Properties_AppProperties">Using AppProperties</a></h2><p>App properties are special properties that can be accessed with very good performance, and therefore are used frequently in the code. They are the properties defined in the <code>AppProperties.trigger</code> file, and are configured in the <code>Config\ConfigManager.txt</code> files of the player. The IDs of the properties that can use the fast access are defined at <a href="namespace_app_1_1_s_p_property_i_ds.html" class="m-doc">App::<wbr />SPPropertyIDs</a>, and they are accessed by using the <code>GetDirectInt()</code>, <code>GetDirectFloat()</code>, <code>GetDirectBool()</code> methods on the <code>AppProperties</code> object:</p><pre class="m-code"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">AppProperties</span><span class="p">.</span><span class="n">GetDirectBool</span><span class="p">(</span><span class="n">App</span><span class="o">::</span><span class="n">SPPropertyIDs</span><span class="o">::</span><span class="n">kWireframe</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span><span class="w"></span></pre></section><section id="Properties_Adding"><h2><a href="#Properties_Adding">Adding properties to a list</a></h2><p>Even though it is less common, it is also possible to add new properties or change the values of existing ones. This is used to store information; for example, Spore generates a property list for each creation.</p><p>Creating a new property list is very simple, you just need to call <code>new</code>. You can then assign a name and folder with the <code>PropManager</code>:</p><pre class="m-code"><span class="n">PropertyListPtr</span><span class="w"> </span><span class="n">propList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">App</span><span class="o">::</span><span class="n">PropertyList</span><span class="p">();</span><span class="w"></span>
<span class="n">PropManager</span><span class="p">.</span><span class="n">SetPropertyList</span><span class="p">(</span><span class="n">propList</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;listName&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;listFolder&quot;</span><span class="p">));</span><span class="w"></span></pre><p>To assign properties, you have to use the <code>SetProperty()</code> method combined with the <code><a href="_object_8h.html#a2e82adf9870bdb442cdcf2b3e01315b2" class="m-doc">SetValueX()</a></code> or <code><a href="_object_8h.html#a2e82adf9870bdb442cdcf2b3e01315b2" class="m-doc">SetArrayX()</a></code> methods of the Property class:</p><pre class="m-code"><span class="n">propList</span><span class="o">-&gt;</span><span class="n">SetProperty</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="s">&quot;dnaAmount&quot;</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Property</span><span class="p">().</span><span class="n">SetValueInt32</span><span class="p">(</span><span class="mi">80</span><span class="p">));</span><span class="w"></span>

<span class="kt">float</span><span class="w"> </span><span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">30.4</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="mf">10.941</span><span class="p">};</span><span class="w"></span>
<span class="n">propList</span><span class="o">-&gt;</span><span class="n">SetProperty</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="s">&quot;scales&quot;</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Property</span><span class="p">().</span><span class="n">SetArrayFloat</span><span class="p">(</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span><span class="w"></span></pre></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Spore ModAPI SDK for creating C++ mods for Spore. Created with <a href="https://doxygen.org/">Doxygen</a> 1.9.8 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
